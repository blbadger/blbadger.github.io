## Fractal Geometry

Images of dynamical systems, as seen in other pages of [this site](https://blbadger.github.io/), are often described as fractals.  This section explores the meaning of this term, its origins, and deep connections between fractals and nonlinear dynamics and other fields.

### Origin and Cantor's set

The term *Fractal* was chosen by Mandelbrot (after the Latin *Fractus*) to signify irregular (after a sense), fragmented objects.  These often but do not necessarily have a fractional scaling dimension, and the surface of these objects is non-differentiable.  Spectacular examples of fractals such as the Julia and Mandelbrot sets are often brought to mind when one thinks of fractals, but they are far older and richer than these examples alone.  Nearly a century before the word fractal had been invented, the foundations for this branch of math were established and are here roughly detailed.

In the late 19th century Cantor founded set theory, a study of abstract collections of objects and the relations between these collections.  Other pages in this website make use of set theory, and for a good background on the subject see "Naive set theory" by Halmos.  From set theory, we find fascinating conclusions that lay a foundation for fractal geometry, so to understand the latter it is best to examine a few key aspects of the former. 

Surprising results abound in set theory, but one of the most relevant here is that pertaining to measurment.  Firstly, not all infinities are equal: there are as many integers as there are rational numbers (an infinite amount of each) but there are far more real numbers than either.  The elegant diagonal proof for this is worth viewing elsewhere, as it reappears again in other forms (in Turing's computability theories, for example). 

A particularly interesting set is known as the middle thirds Cantor set $C$.  This set will be considered in some detail because it illustrates many of the most important aspects of fractals but is relatively simple, existing on a line.  $C$ is made as follows: take the closed interval on the reals $[0, 1]$ and remove from this an open interval of the middle third, that is, $[0, 1] - (1/3, 2/3)$.  

![cantor]({{https://blbadger.github.io}}/fractals/cantor001.png)

Now repeat this process for each remaining closed intervals,

![cantor]({{https://blbadger.github.io}}/fractals/cantor002.png)

and again

![cantor]({{https://blbadger.github.io}}/fractals/cantor003.png)

and so on ad infinitum.  $C$ is the set of numbers that remains after an infinite number of these steps.  This set is remarkable: after n steps of removing the inner third, $(\frac{2}{3})^n$ total length remains.  Therefore $C$ has $0$ total length: $(2/3)^n \to 0 \; as \; n \to \infty$.  If it has $0$ length, does $C$ have any points? It does indeed, just as many points as the original closed interval $[1,0]$!  The set is totally disconnected (no point touches any other point) and perfect (every point is a limit of another set of points in $C$).

```python
from turtle import *
import turtle

for i in range(300):
	turtle.hideturtle()
	turtle.speed(0)
	turtle.delay(0)
	turtle.pensize(4)
	turtle.setup (width=1900, height=1080, startx=0, starty=0)
	turtle.pu()
	turtle.goto(-800, 0)
	turtle.pd()
	def cantor_set(size, recursive_steps):
		if recursive_steps > 0:
			cantor_set(size/3, recursive_steps-1)
			turtle.pu()
			turtle.forward(size)
			turtle.pd()
			cantor_set(size/3, recursive_steps-1)

		else:
			turtle.color('red')
			turtle.forward(size)
			turtle.pu()
			turtle.forward(size)
			turtle.pd()
			turtle.color('blue')
			turtle.forward(size)

	cantor_set(500 * (2**(i/30)), 4 + i // 30)
	turtle_screen = turtle.getscreen()
	turtle_screen.getcanvas().postscript(file="cantor_set{0:03d}.eps".format(i))
	turtle.reset()

```

The `.eps` files generated by this program are vector images, and to make a video conversion to a fixed size .png or .jpg type file is useful.  Fortunately the Python Image Library has the wonderful ability to detect and reformat all kinds of image types!  I used the following program to convert `.eps` to `.png` files:

```python
from PIL import Image
import os

 # insert path here
path = '/home/bbadger/Desktop/' 

files = os.listdir(path)

for i in range(0, len(files)):
	string = str(i)
	while len(string) < 3:
		string = '0' + string
	try:
		eps_image = Image.open('cantor_set' + string + '.eps') # input names here
	except:
		break
	eps_image.load(scale=2)   
	eps_image.save('cantor{0:03d}.png'.format(i)) # output names here
```
After compiling these `.png` images into an mp4 using ffmpeg in bash

```bash
(base) bbadger@bbadger:~$ ffmpeg -f image2 -r 30 -pattern_type glob -i '*.png' cantor_zoom.mp4
```

the video can be viewed and edited.  Here it is as a .gif (ffmpeg can convert directly into gifs simply by changing the extension name to `cantor_zoom.gif`, but these are uncompressed and can be quite large files)

![cantor zoom]({{https://blbadger.github.io}}/fractals/cantor_zoom1.gif)

As the number of recursive calls increases, the Cantor set becomes invisible.  This should not come as a surprise, being that it is of measure $0$ as $n \to \infty$.  Thus in order to obtain a viewable map with more recursive steps, vertical lines are used to denote the position of each point in the set.  The following program accomplishes this by drawing alternating red and blue vertical lines at the start of where each set interval (at any given step) begins and so is only accurate with a relatively large value for the starting number of recursions (>4).  A black background is added for clarity, and once again the number of recursive steps increases with scale to maintain resolution.

```python
from turtle import *
import turtle

for i in range(300):
	turtle.hideturtle()
	turtle.bgcolor('black')
	# turtle.color('white')
	turtle.speed(0)
	turtle.delay(0)
	turtle.pensize(0.001)
	turtle.setup (width=1900, height=1080, startx=0, starty=0)

	# fill the background (bgcolor does not save by itself using .postscript())
	turtle.pu()
	turtle.goto(-1100, -600)
	canvas = turtle.getcanvas()
	turtle.fillcolor(turtle.Screen().bgcolor())
	turtle.begin_fill()
	width = 2200
	height = 1200
	turtle.forward(width+2)
	turtle.left(90)
	turtle.forward(height+2)
	turtle.left(90)
	turtle.forward(width+2)
	turtle.left(90)
	turtle.forward(height+2)
	turtle.left(90)
	turtle.end_fill()

	turtle.pu()
	turtle.goto(-910, -540)
	turtle.pd()

	def cantor_set(size, recursive_steps):
		if recursive_steps > 0:
      			# only proceed if not out of canvas bounds
			if turtle.pos()[0] < 1900:
				cantor_set(size/3, recursive_steps-1)
			turtle.pu()
			turtle.forward(size)
			turtle.pd()
			# only proceed if not out of canvas bounds
			if turtle.pos()[0] < 1900:
				cantor_set(size/3, recursive_steps-1)
		else:
			turtle.color('blue')
			turtle.left(90)
			turtle.forward(1100)
			turtle.right(180)
			turtle.forward(1100)
			turtle.left(90)
			turtle.pu()
			turtle.forward(size)
			turtle.pd()
			turtle.color('red')
			turtle.left(90)
			turtle.forward(1100)
			turtle.right(180)
			turtle.forward(1100)
			turtle.left(90)

	cantor_set(500*2**(i/60), 6 + i // 90)
	turtle_screen = turtle.getscreen()
	turtle_screen.getcanvas().postscript(file="cantor_set{0:03d}.eps".format(i))
	turtle.reset()
	
```

![cantor zoom]({{https://blbadger.github.io}}/fractals/cantor_zoom_vertical.gif)


Now this is one particular example of a Cantor set, but there are others: one coule remove middle halves instead of thirds etc.  The general definition of a Cantor set is any set that is closed, bounded, totally disconnected, and perfect.  The general Cantor set $C$ is a common occurence in nonlinear maps.  The following arrangement of stable versus unstable locations for the [Clifford attractor](/clifford-boundary.md) is a good example of an irregular Cantor set

![clifford]({{https://blbadger.github.io}}clifford_attractor/clifford_bound_zoom1.gif)

as is the [henon map](/henon-map.md), although here the pattern of $C$ is regular.

### Space filling curves

What is the dimension of the Cantor set?  Points or finite collections of points are of dimension $0$, whereas lines are of dimension $1$.  $C$ is totally disconnected and therefore would seem to be $0$ dimensional, and yet it is an infinite collection of points that are bounded to a specific region.  


Note that both of these curves are nowhere-differentiable: pick any point on the curve, and it is a non-differentiable angle.  Indeed it can be shown that any mapping from two to one dimensions (which could be considered to be equivalent to the definition of a space filling curve) is nowhere-differentiable if the mapping is one-to-one and onto.  For some interesting repercussions of this on neural networks, see [here](/neural-networks.md)


### Self-similar fractals

Mandelbrot's [book](https://books.google.com/books/about/The_Fractal_Geometry_of_Nature.html?id=0R2LkE3N7-oC) contains a number of classic fractals, and here are a few re-created.

The Sierpinski triangle (which will resemble a triforce for those of you who played Zelda) is one of the most distinctive fractals presented in the book. There are two orientations the curve takes, which means that the recursion proceeds as follows:

```python
ls = [60, 60, -60, -60, -60, -60, 60, 60, 0]
def sierpinski_curve(size, recursive_steps, ls):
	if recursive_steps == 0:
		turtle.forward(size)
	else:
		for i in range(len(ls)):
			if i % 2 == 0:
				sierpinski_curve(size, recursive_steps-1, [i for i in ls])
				turtle.left(ls[i])
			else:
				sierpinski_curve(size, recursive_steps-1, [-i for i in ls])
				turtle.left(ls[i])

```


![sierpinski]({{https://blbadger.github.io}}/fractals/sierpinski.gif)


### Fractals in the natural world

Fractals can be thought of as objects that are irregular and do not become more regular as one increases scale, as well as objects that have smaller parts that resemble the whole.  These properties are observed in most objects from nature, and a particularly noteworthy example is in coastlines.  Here is a picture of the Chesapeake Bay taken from a sattelite which is found in the Smithsonian museum. 

![chesapeake bay]({{https://blbadger.github.io}}/fractals/chesapeake_bay.png)

Observe how the large bay has many smaller bays that, though not identical in shape, closely resemble the whole bay.  These inlets in turn have smaller inlets and so on past the resolution limit of this image.  This makes the coastline irregular on a large scale but importantly that this irregularity does not diminish with an increase in scale.  

These properties are important because they nullify our attempts to understand such objects by using common measures and techniques.  To be specific, the length of the coastline in the image above is entirely dependent on how high the resolution of the image is: a higher resolution image will yield a larger measurement.  This is not the case for smooth objects that we like to measure, such as the desk I am writing on.  In addition, fractals are non-differentiable: calculus cannot be accurately applied to these objects because at many points they do not have a defined tangent curve. 

